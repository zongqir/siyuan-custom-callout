# 🛠️ Callout拖拽功能故障排除指南

如果你看不到拖拽手柄，请按照以下步骤进行排查：

## 📋 快速检查清单

### 1️⃣ **插件状态检查**
- [ ] 确保插件已重新启用或重新加载
- [ ] 确保插件版本是最新的（包含拖拽功能）
- [ ] 确认没有插件错误信息

### 2️⃣ **Callout状态检查**
- [ ] 确保文档中有正确的callout格式：`[!info]`、`[!tip]` 等
- [ ] 确认引用块已经正确转换为callout样式（有颜色和图标）
- [ ] 验证callout具有 `custom-callout` 属性

### 3️⃣ **浏览器开发工具检查**
1. 按 `F12` 打开开发者工具
2. 切换到 `Console（控制台）` 标签
3. 查看是否有相关的调试信息

## 🔧 使用调试助手

我已经为你添加了一个调试助手，可以快速诊断问题：

### 在浏览器控制台中执行：

```javascript
// 1. 检查callout状态
CalloutDebugHelper.checkCalloutStatus()

// 2. 检查样式是否正确加载
CalloutDebugHelper.checkStyles()

// 3. 手动添加调试版拖拽手柄（红色显眼版本）
CalloutDebugHelper.manuallyAddHandles()
```

## 🚨 常见问题解决方案

### 问题1: 没有找到任何callout
**症状**: 控制台显示 "总callout数量: 0"

**解决方案**:
1. 检查文档格式，确保使用正确的语法：
   ```markdown
   > [!info]
   > 这是信息callout
   ```
2. 确保插件已正确加载并处理引用块
3. 尝试刷新页面或重启插件

### 问题2: 找到callout但没有拖拽手柄
**症状**: 控制台显示有callout但拖拽手柄数量为0

**解决方案**:
1. 执行 `CalloutDebugHelper.manuallyAddHandles()` 添加调试版手柄
2. 检查CSS样式是否正确加载
3. 查看控制台是否有初始化错误

### 问题3: 样式问题
**症状**: 控制台显示缺少拖拽相关CSS

**解决方案**:
1. 重新构建插件：`npm run build`
2. 重新加载插件
3. 清除浏览器缓存

## 📱 响应式提醒

如果你在小屏幕设备上测试（宽度 < 768px），拖拽功能会自动隐藏。请在桌面端进行测试。

## 🔍 详细调试步骤

### 步骤1: 基础检查
```javascript
// 检查是否有callout元素
document.querySelectorAll('.bq[custom-callout]').length

// 检查是否有拖拽手柄
document.querySelectorAll('.callout-resize-handle').length
```

### 步骤2: 样式检查
```javascript
// 检查样式元素是否存在
document.getElementById('custom-callout-styles')

// 检查样式内容
const styleEl = document.getElementById('custom-callout-styles')
styleEl && styleEl.textContent.includes('callout-resize-handle')
```

### 步骤3: 手动测试
如果自动功能有问题，可以使用调试助手手动添加红色的测试拖拽手柄：

```javascript
CalloutDebugHelper.manuallyAddHandles()
```

这会添加红色边框的拖拽手柄，更容易看到。

## 💡 临时解决方案

如果自动拖拽功能暂时不工作，你仍然可以：

1. **手动编辑文档**: 直接在文档中修改 `[!info|30%]` 格式
2. **使用调试手柄**: 通过 `CalloutDebugHelper.manuallyAddHandles()` 添加临时拖拽功能
3. **重新加载页面**: 有时简单的页面刷新就能解决问题

## 📞 获取支持

如果以上步骤都无法解决问题，请：

1. 在控制台执行 `CalloutDebugHelper.checkCalloutStatus()` 
2. 截图控制台输出结果
3. 提供你的浏览器版本和操作系统信息
4. 描述具体的问题表现

## 🎯 预期效果

正常工作时，你应该看到：
- 鼠标悬停在callout右侧时出现半透明的拖拽手柄
- 手柄有毛玻璃效果和点状纹理
- 拖拽时callout实时调整宽度
- 松开鼠标后出现成功通知

---

**🔧 这个指南应该能帮你快速定位和解决拖拽功能的问题！**
