# 📐 Callout 边注拖拽调整功能

## 🎯 功能概述

新增的拖拽调整功能让你可以直观地调整callout（边注）的宽度，调整结果会自动保存到文档中，实现持久化存储。

## ✨ 核心特性

### 🖱️ 直观的拖拽界面
- **智能显示**：鼠标悬停时，callout右侧出现半透明拖拽手柄
- **视觉反馈**：拖拽过程中有高亮效果和实时宽度预览
- **响应式**：小屏幕设备上自动隐藏，确保移动端体验

### 💾 智能持久化
- **格式规范**：调整结果自动写入 `[!info|30%]` 格式
- **参数管理**：智能处理宽度参数的添加、更新和移除
- **全宽优化**：当宽度接近100%时，自动移除宽度限制

### 🔔 即时反馈
- **成功通知**：调整完成后显示绿色成功提示
- **错误处理**：网络或保存失败时显示红色错误提示
- **进度指示**：拖拽过程中的实时宽度显示

## 🚀 使用方法

### 基本操作
1. **创建callout**：输入 `[!info]` 等命令创建边注
2. **显示手柄**：将鼠标移至callout右侧边缘
3. **开始拖拽**：点击并拖拽半透明的调整手柄
4. **完成调整**：松开鼠标，系统自动保存

### 高级技巧
- **精确调整**：缓慢拖拽可以实现更精确的宽度控制
- **快速全宽**：向右拖拽到边界可快速设为全宽
- **批量调整**：可为不同类型的callout设置不同宽度

## 📝 格式说明

### 支持的格式
```markdown
[!info]           # 默认全宽
[!info|30%]      # 30%宽度
[!tip|50%]       # 50%宽度  
[!example|80%]   # 80%宽度
```

### 参数规则
- **宽度范围**：10% - 100%
- **自动清理**：>95%时自动移除宽度参数
- **格式保持**：保留其他参数（如间距等）

## 🎨 界面设计

### 拖拽手柄样式
- **位置**：callout右侧边缘外8px
- **尺寸**：16x40px的交互区域
- **外观**：毛玻璃效果，点状纹理
- **状态**：悬停时显示，拖拽时高亮

### 视觉反馈
- **拖拽状态**：边框阴影加强，禁用文本选择
- **成功动画**：绿色通知从右上角滑入
- **错误提示**：红色通知，持续时间更长

## ⚡ 性能优化

- **事件优化**：使用防抖机制减少API调用
- **DOM复用**：智能管理拖拽手柄的创建和销毁
- **内存管理**：及时清理事件监听器和DOM元素
- **响应式**：根据屏幕尺寸自动启用/禁用功能

## 🔧 技术实现

### 核心模块
- `CalloutDragResizer`: 拖拽调整核心类
- `generateDragResizeCSS()`: 样式生成函数
- `updateKramdownWidth()`: 文档格式更新

### 集成方式
- 在 `CalloutManager` 中自动初始化
- 与现有callout系统无缝集成
- 保持向后兼容性

## 🌟 用户体验

### 直观操作
- **零学习成本**：符合用户直觉的拖拽操作
- **即时反馈**：所见即所得的调整效果
- **容错设计**：智能边界检测，防止无效操作

### 可访问性
- **键盘友好**：不影响键盘导航
- **屏幕阅读器**：适当的aria标签和提示
- **触摸支持**：在支持的设备上也能正常使用

## 📱 响应式设计

```css
@media (max-width: 768px) {
    .callout-resize-handle {
        display: none !important;
    }
}
```

小屏幕设备上自动隐藏拖拽功能，避免误操作。

---

**🎉 这个功能让callout的宽度调整变得前所未有的简单直观！**
